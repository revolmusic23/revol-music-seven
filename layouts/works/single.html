<!-- layouts/works/single.html -->
{{ define "main" }}
  {{ $slug := .File.TranslationBaseName }}
  {{ $work := index (where site.Data.works.work "slug" $slug) 0 }}
  <!-- {{ $slug := index (last 1 (split (delimit (split .RelPermalink "/") "/" "") "")) 0 }}
  {{ $work := index (where site.Data.works "slug" $slug) 0 }} -->

  <!-- 使用 $work 變量來訪問 JSON 數據 -->
  <div id="hs-content-container" class="my-5 w-full rounded-b-lg px-5 md:px-10 lg:px-1">
    <div class="container max-w-5xl mx-auto flex gap-8">
      <!-- 左側欄 -->
      <div class="w-1/3 sticky top-40">
        <div class="{{ .Site.Params.styles.cardClass }} p-4">
          {{ if $work.image }}
            <div id="hs-feature" class="aspect-square w-full">
              <img class="w-full object-cover" src="{{ $work.image }}" alt="{{ $work.title }}" />
            </div>
          {{ end }}
        </div>
      </div>

      <!-- 內容區域 -->
      <div id="hs-container" class="w-2/3">
        <div class="{{ .Site.Params.styles.cardClass }} p-5">
          <h1 class="text-3xl font-bold mb-2">{{ $work.title }}</h1>
          <div class="text-sm text-gray-600 mb-4">{{ $work.date }}</div>
          <p class="text-lg mb-6">{{ $work.participate }}</p>

          {{ if $work.audio }}
            <h2 class="text-xl font-bold mt-8 mb-4">音檔</h2>
            {{ partial "audio.html" (dict "src" $work.audio) }}
          {{ end }}

          {{ if $work.instrumental }}
            <h2 class="text-xl font-bold mt-8 mb-4">伴奏檔</h2>
            {{ partial "audio.html" (dict "src" $work.instrumental) }}
          {{ end }}

          {{ if $work.lyrics_file }}
            <h2 class="text-xl font-bold mt-8 mb-4">歌詞</h2>
            {{ with site.GetPage (printf "lyrics/%s" $work.lyrics_file) }}
              {{ .Content }}
            {{ end }}
          {{ end }}

          {{ if $work.youtube }}
            <h2 class="text-xl font-bold mt-8 mb-4">MV</h2>
            {{ partial "youtube.html" (dict "id" $work.youtube) }}
          {{ end }}
        </div>
      </div>
    </div>
  </div>
{{ end }}
